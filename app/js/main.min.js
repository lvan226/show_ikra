$(function () {
  // Слайдер галереи
  $('.gallery__slider').slick({
    slidesToShow: 1,
    dots: true,
    nextArrow: '<button class="slick-next slick-arrow" aria-label="Next" type="button"></button>',
    prevArrow: '<button class="slick-prev slick-arrow" aria-label="Prev" type="button"></button>',
  });
  // Конец слайдера галереи


  // Меню гамбургер начало
  $('.menu-burger').on('click', function () {
    $('.menu-burger').toggleClass('active');
    $('.menu__list').toggleClass('active');
  });
  $('.close').on('click', function () {
    $('.menu-burger').toggleClass('active');
    $('.menu__list').toggleClass('active');
  });
  // Меню гамбургер конец




  var h_hght = $('.banner').height();
  var h_mrg = 0; // отступ когда шапка уже не видна
  var top = $(window).scrollTop();
  var elem = $('#top_nav');
  if (top + h_mrg < h_hght) {
    elem.css('top', (h_hght - top));
    elem.css('background', "transparent")
  } else {
    elem.css('top', h_mrg);
    elem.css('background', "#fff")
  }
  menuFixed(h_hght, h_mrg);

  // Ресайз окна
  var rtime;
  var timeout = false;
  var delta = 200;
  $(window).resize(function () {
    rtime = new Date();
    if (timeout === false) {
      timeout = true;
      setTimeout(resizeend, delta);
    }
  });

  function resizeend() {
    if (new Date() - rtime < delta) {
      setTimeout(resizeend, delta);
    } else {
      timeout = false;
      // alert('Done resizing');
      h_hght = $('.banner').height();
      var elem = $('#top_nav');
      var top = $(this).scrollTop();
      if (top + h_mrg < h_hght) {
        elem.css('top', (h_hght - top));
        elem.css('background', "transparent")
      } else {
        elem.css('top', h_mrg);
        elem.css('background', "#fff")
      }
      menuFixed(h_hght, h_mrg);
    }
  }
  // Ресайз окна конец



  // Слайдер афиши
  $('.poster__slider').slick({
    slidesToShow: 3,
    dots: true,
    nextArrow: '<button class="slick-next slick-arrow" aria-label="Next" type="button"></button>',
    prevArrow: '<button class="slick-prev slick-arrow" aria-label="Prev" type="button"></button>',
    variableWidth: true,
    centerMode: true
  });
  // Конец слайдера афиши

  
  $('.btn-modal').on('click', function () {
    $("#modal").addClass('active');
    $('.overlay').addClass('active');
  });
  $('.overlay').on('click', function () {
    $("#modal").removeClass('active');
    $('.overlay').removeClass('active');
  });

  $("#menu").on("click","a", function (event) {
    var id  = $(this).attr('href'); //заберем айдишник блока с параметром URL
    if (id[0] == '#') {
      event.preventDefault(); //опустошим стандартную обработку
			var top = $(id).offset().top; //определим высоту от начала страницы до якоря
	  $('body,html').animate({scrollTop: top - 30}, 1000); //сделаем прокрутку за 1 с
    }
  });

  let links = document.querySelectorAll('.link-helper');

  for (let i = 0; i < links.length; i++) {
    links[i].addEventListener('click', () => {
      let menuBurger = document.querySelector('.menu-burger');
      let menuList = document.querySelector('.menu__list');
      menuBurger.classList.remove('active');
      menuList.classList.remove('active');
    });
  }

  let protectModal = document.getElementById('protect');
  let protectOpen = document.getElementById('protect-open');
  let protectClose = document.querySelector('.protect-close');

  protectOpen.addEventListener('click', () => {
    protectModal.classList.add('active');
  });

  protectClose.addEventListener('click', () => {
    protectModal.classList.remove('active');
  });

});


// Функция срабатывает при прокрутке экрана
function menuFixed(one, two) {
  $(window).scroll(function () {
    var top = $(this).scrollTop();
    var elem = $('#top_nav');
    var h_hght = one;
    var h_mrg = two;
    if (top + h_mrg < h_hght) {
      elem.css('top', (h_hght - top));
      elem.css('background', "transparent")
    } else {
      elem.css('top', h_mrg);
      elem.css('background', "#fff")
    }
  });
}